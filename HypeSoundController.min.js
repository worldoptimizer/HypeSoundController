/*!
 * Hype Sound Controller v1.4.0
 * copyright (c) 2025 Max Ziebell, (https://maxziebell.de). MIT-license
 */
'use strict';!1==="HypeSoundController"in window&&(window.HypeSoundController=function(){function u(a){return a?m[a]:m}function g(a){a=a.documentId?a.documentId():a.documentName();q[a]||(q[a]={sounds:{},buckets:{},muteState:{global:!1,buckets:{}}});return q[a]}function v(a,b){return a.muteState.global?!0:(b=a.sounds[b])&&a.muteState.buckets[b.bucket]}function p(a,b,c,d){a._fadeInterval&&clearInterval(a._fadeInterval);const e=1E3*c;if(e){var f=a.volume,h=Date.now();a._fadeInterval=setInterval(function(){var k=
Date.now()-h;k=Math.min(k/e,1);a.volume=f+(b-f)*k;1<=k&&(clearInterval(a._fadeInterval),delete a._fadeInterval,d&&d())},16)}else a.volume=b,d&&d()}function y(a,b,c){const d=g(a),e=c&&c.alias||b.replace(/\.[^/.]+$/,"");d.sounds[e]||(b=/\//.test(b)?b:a.resourcesFolderURL()+"/"+b,d.sounds[e]=Object.assign({},u(),c,{alias:e,src:b,playingInstances:[]}),c=d.sounds[e].bucket,d.buckets[c]||(d.buckets[c]=[]),d.buckets[c].push(e),l(a))}function r(a,b,c){const d=g(a),e=d.sounds[b];if(!e)return console.warn('HypeSoundController: Sound "'+
b+'" not loaded.');const f=Object.assign({},e,c);f.stopOthers&&n(a,b,{fadeOut:f.fadeOut});const h=new Audio(e.src);h.loop=f.loop;h.muted=v(d,b);h.volume=0<f.fadeIn?0:f.volume;h.addEventListener("ended",function(){a.triggerCustomBehaviorNamed("Audio Ended");a.triggerCustomBehaviorNamed("Audio Ended "+b);const k=e.playingInstances.indexOf(h);-1!==k&&e.playingInstances.splice(k,1)});e.playingInstances.push(h);c=h.play();void 0!==c&&c.then(function(){p(h,f.volume,f.fadeIn);a.triggerCustomBehaviorNamed("Audio Started");
a.triggerCustomBehaviorNamed("Audio Started "+b)}).catch(function(k){k=e.playingInstances.indexOf(h);-1!==k&&e.playingInstances.splice(k,1);a.triggerCustomBehaviorNamed("Audio Failed");a.triggerCustomBehaviorNamed("Audio Failed "+b)});l(a);return h}function z(a,b,c){if(b=g(a).sounds[b]){var d=Object.assign({},b,c);b.playingInstances.forEach(function(e){p(e,0,d.fadeOut,function(){e.pause()})});l(a)}}function A(a,b,c){const d=g(a).sounds[b];if(d){var e=Object.assign({},d,c);if(0===d.playingInstances.length)return r(a,
b,c);d.playingInstances.forEach(function(f){f.paused&&(f.play().catch(function(){}),p(f,e.volume,e.fadeIn))})}}function n(a,b,c){if(b=g(a).sounds[b]){var d=Object.assign({},b,c);c=b.playingInstances.slice();b.playingInstances=[];c.forEach(function(e){p(e,0,d.fadeOut,function(){e.pause();e.currentTime=0})});l(a)}}function B(a,b){n(a,b);const c=g(a);var d=c.sounds[b];d&&(d=d.bucket,c.buckets[d]&&(c.buckets[d]=c.buckets[d].filter(function(e){return e!==b})),delete c.sounds[b],l(a))}function C(a,b){return!!g(a).sounds[b]}
function t(a,b){return(a=g(a).sounds[b])?a.playingInstances.some(function(c){return!c.paused&&!c.ended}):!1}function D(a,b){const c=g(a);(b?c.buckets[b]||[]:Object.keys(c.sounds)).forEach(function(d){n(a,d)});l(a)}function E(a,b){const c=g(a);b?(c.muteState.buckets[b]=!0,b=c.buckets[b]||[]):(c.muteState.global=!0,b=Object.keys(c.sounds));w(c,b);l(a)}function F(a,b){const c=g(a);b?(c.muteState.buckets[b]=!1,b=c.buckets[b]||[]):(c.muteState.global=!1,b=Object.keys(c.sounds));w(c,b);l(a)}function G(a,
b){a=g(a);return b?!!a.muteState.buckets[b]:a.muteState.global}function H(a){return Object.keys(g(a).sounds)}function x(a,b){return g(a).buckets[b]||[]}function I(a,b,c,d){x(a,b).forEach(function(e){e===c?t(a,e)||r(a,e,d):t(a,e)&&n(a,e)})}function w(a,b){b=b||Object.keys(a.sounds);b.forEach(function(c){const d=a.sounds[c];if(d){var e=v(a,c);d.playingInstances.forEach(function(f){f.muted=e})}})}function l(a){"function"===typeof a.refreshReactiveContentDebounced&&a.refreshReactiveContentDebounced()}
let m={bucket:"default",loop:!1,volume:1,stopOthers:!0,fadeIn:0,fadeOut:0};const q={};!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeDocumentLoad",callback:function(a,b,c){b={loadSound:y,playSound:r,pauseSound:z,resumeSound:A,stopSound:n,unloadSound:B,isSoundLoaded:C,isSoundPlaying:t,stopAllSounds:D,muteAllSounds:E,unmuteAllSounds:F,isMuted:G,getLoadedSounds:H,getSoundsInBucket:x,playOnlyInBucket:I};for(const d in b)b.hasOwnProperty(d)&&
(a[d]=b[d].bind(null,a))}});return{version:"1.4.0",setDefault:function(a,b){"object"===typeof a?m=Object.assign(m,a):m[a]=b},getDefault:u}}());
